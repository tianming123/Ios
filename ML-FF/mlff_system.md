### 记录日期

2022-02-31

### 内容概要

MLFF软件包中system文件作用的说明

#### system文件描述

system文件中定义System类, System类对应于一个体系的第一性原理MD(AIMD)中MLFF关心的所有信息. 因此必然要从AIMD的输出文件中选择一个或几个主要输出文件作为System类的输入文件.

对于PWmat,  这个文件是MOVEMENT

对于VASP, 这个文件是vasprun.xml, 此外因为vasprun.xml文件作为VASP的主要输出文件, 包含绝大多数输入输出信息, 已经写了VasprunData类读其信息, System类中可以直接利用

需要注意的是, 总体的工作必定是将每一个AIMD的系统, 即相关的输出文件放在一个单独的文件夹下, 然后程度自动读取子文件夹下包含的所有系统. 

#### System类设计需要完成的工作

1. **读文件**

   即需要读入相应的AIMD的输出文件, 得到相关的信息, 包括:

   1. 原子<u>种类列表</u>
   2. 每一MD步的原子<u>位置</u>
   3. 每一MD步的原子<u>受力</u>
   3. 每一MD步的<u>cell基矢</u>
   4. 每一MD步的<u>总势能</u>, PWmat中还有每一步每个原子的能量

2. **读写二进制文件**,  
    即考虑将读入过的信息写成二进制文件以后不必再重读文本，可以利用numpy.save, 之前一直是每一种信息分别存, 为简约代码, 不如可以直接存system对象本身
    写入二进制文件后, 还需要考虑如何读入, 以及在一个系统文件夹下, 应该优先读取二进制文件.
    
3. **计算最大原子近邻数**

    即计算所有MD步中的最大原子近邻数, 这里需要用到截断半径的参数, 应该是parameters.rcut

    要算这个是考虑有可能能动态自动设置最大原子近邻数, 至少也可以用于参考

4. **计算其他一些参数**

    包括但不限于

    1.  <u>每类</u>原子的信息

       每一种原子的列表或者mask, 即例如序数为1的原子是哪些, 或者一个bool的mask

    2. 每步MD总势能的统计

       即统计看是否有哪些MD步的势能偏离很远, 可能要删除

    3. 原子数和MD步数

       num_atom, num_image

5. **通过index返回Image对象**

    此处与Image对象的\__init\__有关

    

     